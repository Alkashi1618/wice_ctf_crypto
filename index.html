<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WiCE CTF 2025 - CryptoLab</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.3.2/jsencrypt.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, sans-serif;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Icones Lucide
        const Lock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
        );

        const Unlock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
        );

        const Key = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
            </svg>
        );

        const Shield = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
        );

        const Flag = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                <line x1="4" y1="22" x2="4" y2="15"/>
            </svg>
        );

        const Sparkles = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"/>
            </svg>
        );

        const AlertCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        const Cpu = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <rect x="4" y="4" width="16" height="16" rx="2"/>
                <rect x="9" y="9" width="6" height="6"/>
                <path d="M9 2v2M15 2v2M9 22v2M15 22v2M2 9h2M2 15h2M22 9h2M22 15h2"/>
            </svg>
        );

        const FileKey = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                <circle cx="10" cy="16" r="2"/>
                <path d="m16 10-4.5 4.5M15 11l1 1"/>
            </svg>
        );

        const Hash = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <line x1="4" y1="9" x2="20" //y1="9"
                />
                <line x1="4" y1="15" x2="20" //y1="15"
                />
                <line x1="10" y1="3" x2="8" //y1="21"
                />
                <line x1="16" y1="3" x2="14" //y1="21"
                />
            </svg>
        );

        const Fingerprint = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M12 10a2 2 0 0 0-2 2c0 1.02-.06 2.51-.34 3.57-.21.75.33 1.43 1.03 1.43h2.62c.7 0 1.24-.68 1.03-1.43-.28-1.06-.34-2.55-.34-3.57a2 2 0 0 0-2-2z"/>
                <path d="M12 10v4"/>
                <path d="M12 18h.01"/>
                <path d="M7 15a5 5 0 0 1 10 0"/>
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
        );

        // ==================== GESTIONNAIRE DE HACHAGE ====================
        const HashManager = () => {
            const [hashInput, setHashInput] = useState('');
            const [hashResults, setHashResults] = useState({});
            const [selectedAlgorithm, setSelectedAlgorithm] = useState('SHA256');

            const hashAlgorithms = [
                { id: 'MD5', name: 'MD5', color: 'from-red-500 to-pink-500' },
                { id: 'SHA1', name: 'SHA-1', color: 'from-orange-500 to-red-500' },
                { id: 'SHA256', name: 'SHA-256', color: 'from-green-500 to-emerald-500' },
                { id: 'SHA512', name: 'SHA-512', color: 'from-blue-500 to-cyan-500' },
                { id: 'SHA3', name: 'SHA-3', color: 'from-purple-500 to-pink-500' }
            ];

            const computeHashes = (text) => {
                if (!text.trim()) {
                    setHashResults({});
                    return;
                }

                const results = {
                    MD5: CryptoJS.MD5(text).toString(),
                    SHA1: CryptoJS.SHA1(text).toString(),
                    SHA256: CryptoJS.SHA256(text).toString(),
                    SHA512: CryptoJS.SHA512(text).toString(),
                    SHA3: CryptoJS.SHA3(text).toString()
                };

                setHashResults(results);
            };

            const handleInputChange = (text) => {
                setHashInput(text);
                computeHashes(text);
            };

            const copyToClipboard = (hash) => {
                navigator.clipboard.writeText(hash);
                alert('Hash copi√© dans le presse-papier !');
            };

            return (
                <div className="space-y-6">
                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h3 className="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                            <Hash className="w-5 h-5 text-indigo-400" />
                            Calcul de Hachage
                        </h3>
                        
                        <textarea
                            value={hashInput}
                            onChange={(e) => handleInputChange(e.target.value)}
                            placeholder="Entrez le texte √† hacher..."
                            className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg h-32 mb-4 border border-purple-500/30"
                        />

                        <div className="grid grid-cols-2 md:grid-cols-5 gap-2 mb-6">
                            {hashAlgorithms.map(algo => (
                                <button
                                    key={algo.id}
                                    onClick={() => setSelectedAlgorithm(algo.id)}
                                    className={`py-2 px-3 rounded-lg font-medium text-sm transition-all ${
                                        selectedAlgorithm === algo.id
                                            ? `bg-gradient-to-r ${algo.color} text-white shadow-lg`
                                            : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50'
                                    }`}
                                >
                                    {algo.name}
                                </button>
                            ))}
                        </div>

                        {hashInput && (
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-indigo-300 mb-2 font-medium">
                                        R√©sultat {hashAlgorithms.find(a => a.id === selectedAlgorithm)?.name}
                                    </label>
                                    <div className="bg-gradient-to-r from-indigo-900/50 to-purple-900/50 text-white px-4 py-3 rounded-lg border-2 border-indigo-500/50 font-mono text-sm break-all">
                                        {hashResults[selectedAlgorithm]}
                                    </div>
                                    <button
                                        onClick={() => copyToClipboard(hashResults[selectedAlgorithm])}
                                        className="mt-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all"
                                    >
                                        üìã Copier
                                    </button>
                                </div>

                                <div className="bg-slate-700/30 rounded-lg p-4">
                                    <h4 className="text-white font-semibold mb-3">Tous les hachages</h4>
                                    <div className="space-y-2">
                                        {Object.entries(hashResults).map(([algo, hash]) => (
                                            <div key={algo} className="flex items-center justify-between">
                                                <span className="text-slate-300 text-sm">{algo}:</span>
                                                <code className="text-green-400 text-xs font-mono truncate max-w-xs">
                                                    {hash}
                                                </code>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h3 className="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                            <Fingerprint className="w-5 h-5 text-blue-400" />
                            Information sur le Hachage
                        </h3>
                        <div className="text-slate-300 space-y-3">
                            <p><strong>üîê Qu'est-ce que le hachage ?</strong></p>
                            <p className="text-sm">Le hachage est une fonction qui transforme des donn√©es de taille variable en une cha√Æne de taille fixe. C'est unidirectionnel - impossible de retrouver les donn√©es originales.</p>
                            
                            <p><strong>üéØ Utilisations courantes :</strong></p>
                            <ul className="text-sm list-disc list-inside space-y-1">
                                <li>V√©rification d'int√©grit√© de fichiers</li>
                                <li>Stockage s√©curis√© de mots de passe</li>
                                <li>Signatures digitales</li>
                                <li>Preuves de travail (Blockchain)</li>
                            </ul>

                            <p><strong>‚ö° Algorithmes disponibles :</strong></p>
                            <div className="grid grid-cols-2 gap-2 text-sm">
                                <div className="bg-red-500/10 p-2 rounded">MD5 - 128 bits (obsol√®te)</div>
                                <div className="bg-orange-500/10 p-2 rounded">SHA-1 - 160 bits (d√©pr√©ci√©)</div>
                                <div className="bg-green-500/10 p-2 rounded">SHA-256 - 256 bits (s√©curis√©)</div>
                                <div className="bg-blue-500/10 p-2 rounded">SHA-512 - 512 bits (tr√®s s√©curis√©)</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // ==================== IMPL√âMENTATION AES ====================
        const AESManager = () => {
            const [aesKey, setAesKey] = useState('');
            const [aesInput, setAesInput] = useState('');
            const [aesOutput, setAesOutput] = useState('');
            const [aesMode, setAesMode] = useState('encrypt');

            const generateAESKey = () => {
                const key = CryptoJS.lib.WordArray.random(32);
                const keyBase64 = CryptoJS.enc.Base64.stringify(key);
                setAesKey(keyBase64);
            };

            const encryptAES = (text, key) => {
                try {
                    const keyBytes = CryptoJS.enc.Base64.parse(key);
                    const iv = CryptoJS.lib.WordArray.random(16);
                    
                    const encrypted = CryptoJS.AES.encrypt(text, keyBytes, {
                        iv: iv,
                        mode: CryptoJS.mode.CBC,
                        padding: CryptoJS.pad.Pkcs7
                    });
                    
                    const combined = iv.concat(encrypted.ciphertext);
                    return CryptoJS.enc.Base64.stringify(combined);
                } catch (error) {
                    throw new Error('Erreur de chiffrement AES: ' + error.message);
                }
            };

            const decryptAES = (encryptedBase64, key) => {
                try {
                    const keyBytes = CryptoJS.enc.Base64.parse(key);
                    const combined = CryptoJS.enc.Base64.parse(encryptedBase64);
                    
                    const iv = CryptoJS.lib.WordArray.create(combined.words.slice(0, 4));
                    const ciphertext = CryptoJS.lib.WordArray.create(combined.words.slice(4));
                    
                    const decrypted = CryptoJS.AES.decrypt(
                        { ciphertext: ciphertext },
                        keyBytes,
                        {
                            iv: iv,
                            mode: CryptoJS.mode.CBC,
                            padding: CryptoJS.pad.Pkcs7
                        }
                    );
                    
                    return decrypted.toString(CryptoJS.enc.Utf8);
                } catch (error) {
                    throw new Error('Erreur de d√©chiffrement AES: ' + error.message);
                }
            };

            const handleAESProcess = () => {
                if (!aesKey) {
                    alert('Veuillez d\'abord g√©n√©rer une cl√© AES');
                    return;
                }

                try {
                    if (aesMode === 'encrypt') {
                        const encrypted = encryptAES(aesInput, aesKey);
                        setAesOutput(encrypted);
                    } else {
                        const decrypted = decryptAES(aesInput, aesKey);
                        setAesOutput(decrypted);
                    }
                } catch (error) {
                    alert(error.message);
                }
            };

            return (
                <div className="space-y-6">
                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h3 className="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                            <Cpu className="w-5 h-5 text-blue-400" />
                            Cl√© AES-256
                        </h3>
                        <div className="flex gap-3">
                            <button
                                onClick={generateAESKey}
                                className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold transition-all"
                            >
                                G√©n√©rer Cl√©
                            </button>
                            <input
                                type="text"
                                value={aesKey}
                                onChange={(e) => setAesKey(e.target.value)}
                                placeholder="Cl√© AES (Base64)"
                                className="flex-1 bg-slate-700/50 text-white px-4 py-2 rounded-lg border border-purple-500/30"
                            />
                        </div>
                        {aesKey && (
                            <p className="text-green-400 text-sm mt-2">
                                ‚úÖ Cl√© AES-256 g√©n√©r√©e ({aesKey.length} caract√®res)
                            </p>
                        )}
                    </div>

                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h3 className="text-lg font-semibold text-white mb-4">
                            {aesMode === 'encrypt' ? 'üîê Chiffrement AES' : 'üîì D√©chiffrement AES'}
                        </h3>
                        
                        <div className="flex gap-3 mb-4">
                            <button
                                onClick={() => setAesMode('encrypt')}
                                className={`flex-1 py-2 rounded-lg font-medium ${
                                    aesMode === 'encrypt'
                                        ? 'bg-blue-600 text-white'
                                        : 'bg-slate-700/50 text-slate-300'
                                }`}
                            >
                                Chiffrer
                            </button>
                            <button
                                onClick={() => setAesMode('decrypt')}
                                className={`flex-1 py-2 rounded-lg font-medium ${
                                    aesMode === 'decrypt'
                                        ? 'bg-blue-600 text-white'
                                        : 'bg-slate-700/50 text-slate-300'
                                }`}
                            >
                                D√©chiffrer
                            </button>
                        </div>

                        <textarea
                            value={aesInput}
                            onChange={(e) => setAesInput(e.target.value)}
                            placeholder={aesMode === 'encrypt' ? 'Message √† chiffrer...' : 'Message chiffr√© (Base64)...'}
                            className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg h-32 mb-4 border border-purple-500/30"
                        />

                        <button
                            onClick={handleAESProcess}
                            className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all"
                        >
                            {aesMode === 'encrypt' ? 'üîê Chiffrer avec AES' : 'üîì D√©chiffrer avec AES'}
                        </button>

                        {aesOutput && (
                            <div className="mt-4">
                                <label className="block text-blue-300 mb-2 font-medium">
                                    {aesMode === 'encrypt' ? '‚úÖ Message chiffr√©' : '‚úÖ Message d√©chiffr√©'}
                                </label>
                                <div className="bg-gradient-to-r from-blue-900/50 to-purple-900/50 text-white px-4 py-3 rounded-lg min-h-20 break-words border-2 border-blue-500/50 font-mono">
                                    {aesOutput}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // ==================== IMPL√âMENTATION RSA ====================
        const RSAManager = () => {
            const [rsaPrivateKey, setRsaPrivateKey] = useState('');
            const [rsaPublicKey, setRsaPublicKey] = useState('');
            const [rsaInput, setRsaInput] = useState('');
            const [rsaOutput, setRsaOutput] = useState('');
            const [rsaMode, setRsaMode] = useState('encrypt');
            const [rsaSignature, setRsaSignature] = useState('');

            const generateRSAKeys = () => {
                const crypt = new JSEncrypt({ default_key_size: "2048" });
                crypt.getKey();
                
                setRsaPrivateKey(crypt.getPrivateKey());
                setRsaPublicKey(crypt.getPublicKey());
            };

            const encryptRSA = (text, publicKey) => {
                const crypt = new JSEncrypt();
                crypt.setPublicKey(publicKey);
                const encrypted = crypt.encrypt(text);
                if (!encrypted) throw new Error('Erreur de chiffrement RSA');
                return encrypted;
            };

            const decryptRSA = (encryptedBase64, privateKey) => {
                const crypt = new JSEncrypt();
                crypt.setPrivateKey(privateKey);
                const decrypted = crypt.decrypt(encryptedBase64);
                if (!decrypted) throw new Error('Erreur de d√©chiffrement RSA');
                return decrypted;
            };

            const signMessage = (message, privateKey) => {
                const crypt = new JSEncrypt();
                crypt.setPrivateKey(privateKey);
                const signature = crypt.sign(message, CryptoJS.SHA256, "sha256");
                if (!signature) throw new Error('Erreur de signature');
                return signature;
            };

            const verifySignature = (message, signature, publicKey) => {
                const crypt = new JSEncrypt();
                crypt.setPublicKey(publicKey);
                return crypt.verify(message, signature, CryptoJS.SHA256);
            };

            const handleRSAProcess = () => {
                try {
                    if (rsaMode === 'encrypt') {
                        if (!rsaPublicKey) throw new Error('Cl√© publique requise');
                        const encrypted = encryptRSA(rsaInput, rsaPublicKey);
                        setRsaOutput(encrypted);
                    } else if (rsaMode === 'decrypt') {
                        if (!rsaPrivateKey) throw new Error('Cl√© priv√©e requise');
                        const decrypted = decryptRSA(rsaInput, rsaPrivateKey);
                        setRsaOutput(decrypted);
                    } else if (rsaMode === 'sign') {
                        if (!rsaPrivateKey) throw new Error('Cl√© priv√©e requise');
                        const signature = signMessage(rsaInput, rsaPrivateKey);
                        setRsaSignature(signature);
                    } else if (rsaMode === 'verify') {
                        if (!rsaPublicKey) throw new Error('Cl√© publique requise');
                        const isValid = verifySignature(rsaInput, rsaSignature, rsaPublicKey);
                        setRsaOutput(isValid ? '‚úÖ Signature VALIDE' : '‚ùå Signature INVALIDE');
                    }
                } catch (error) {
                    alert(error.message);
                }
            };

            return (
                <div className="space-y-6">
                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h3 className="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                            <FileKey className="w-5 h-5 text-green-400" />
                            Cl√©s RSA-2048
                        </h3>
                        <button
                            onClick={generateRSAKeys}
                            className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold transition-all mb-4"
                        >
                            G√©n√©rer Paire de Cl√©s
                        </button>

                        <div className="grid md:grid-cols-2 gap-4">
                            <div>
                                <label className="block text-green-300 mb-2">Cl√© Publique</label>
                                <textarea
                                    value={rsaPublicKey}
                                    onChange={(e) => setRsaPublicKey(e.target.value)}
                                    placeholder="Cl√© publique RSA..."
                                    className="w-full bg-slate-700/50 text-white px-4 py-2 rounded-lg h-32 text-sm font-mono border border-purple-500/30"
                                />
                            </div>
                            <div>
                                <label className="block text-green-300 mb-2">Cl√© Priv√©e</label>
                                <textarea
                                    value={rsaPrivateKey}
                                    onChange={(e) => setRsaPrivateKey(e.target.value)}
                                    placeholder="Cl√© priv√©e RSA..."
                                    className="w-full bg-slate-700/50 text-white px-4 py-2 rounded-lg h-32 text-sm font-mono border border-purple-500/30"
                                />
                            </div>
                        </div>
                    </div>

                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h3 className="text-lg font-semibold text-white mb-4">
                            {rsaMode === 'encrypt' && 'üîê Chiffrement RSA'}
                            {rsaMode === 'decrypt' && 'üîì D√©chiffrement RSA'}
                            {rsaMode === 'sign' && '‚úçÔ∏è Signature RSA'}
                            {rsaMode === 'verify' && '‚úÖ V√©rification Signature'}
                        </h3>

                        <div className="grid grid-cols-2 md:grid-cols-4 gap-2 mb-4">
                            {['encrypt', 'decrypt', 'sign', 'verify'].map((mode) => (
                                <button
                                    key={mode}
                                    onClick={() => setRsaMode(mode)}
                                    className={`py-2 rounded-lg font-medium text-sm ${
                                        rsaMode === mode
                                            ? 'bg-green-600 text-white'
                                            : 'bg-slate-700/50 text-slate-300'
                                    }`}
                                >
                                    {mode === 'encrypt' && 'Chiffrer'}
                                    {mode === 'decrypt' && 'D√©chiffrer'}
                                    {mode === 'sign' && 'Signer'}
                                    {mode === 'verify' && 'V√©rifier'}
                                </button>
                            ))}
                        </div>

                        <textarea
                            value={rsaInput}
                            onChange={(e) => setRsaInput(e.target.value)}
                            placeholder={
                                rsaMode === 'encrypt' ? 'Message √† chiffrer...' :
                                rsaMode === 'decrypt' ? 'Message chiffr√©...' :
                                'Message √† signer/v√©rifier...'
                            }
                            className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg h-32 mb-4 border border-purple-500/30"
                        />

                        {rsaMode === 'verify' && (
                            <textarea
                                value={rsaSignature}
                                onChange={(e) => setRsaSignature(e.target.value)}
                                placeholder="Signature √† v√©rifier..."
                                className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg h-20 mb-4 border border-purple-500/30"
                            />
                        )}

                        <button
                            onClick={handleRSAProcess}
                            className="w-full bg-gradient-to-r from-green-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-green-700 hover:to-purple-700 transition-all"
                        >
                            {rsaMode === 'encrypt' && 'üîê Chiffrer avec RSA'}
                            {rsaMode === 'decrypt' && 'üîì D√©chiffrer avec RSA'}
                            {rsaMode === 'sign' && '‚úçÔ∏è Signer le message'}
                            {rsaMode === 'verify' && '‚úÖ V√©rifier la signature'}
                        </button>

                        {(rsaOutput || rsaSignature) && (
                            <div className="mt-4 space-y-4">
                                {rsaOutput && (
                                    <div>
                                        <label className="block text-green-300 mb-2 font-medium">
                                            {rsaMode === 'encrypt' && '‚úÖ Message chiffr√©'}
                                            {rsaMode === 'decrypt' && '‚úÖ Message d√©chiffr√©'}
                                            {rsaMode === 'verify' && 'R√©sultat'}
                                        </label>
                                        <div className="bg-gradient-to-r from-green-900/50 to-purple-900/50 text-white px-4 py-3 rounded-lg min-h-20 break-words border-2 border-green-500/50 font-mono">
                                            {rsaOutput}
                                        </div>
                                    </div>
                                )}
                                {rsaSignature && rsaMode === 'sign' && (
                                    <div>
                                        <label className="block text-green-300 mb-2 font-medium">‚úçÔ∏è Signature g√©n√©r√©e</label>
                                        <div className="bg-gradient-to-r from-green-900/50 to-purple-900/50 text-white px-4 py-3 rounded-lg min-h-20 break-words border-2 border-green-500/50 font-mono">
                                            {rsaSignature}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // ==================== COMPOSANT PRINCIPAL ====================
        const CryptoApp = () => {
            const [activeTab, setActiveTab] = useState('classique');
            const [mode, setMode] = useState('encrypt');
            const [algorithm, setAlgorithm] = useState('cesar');
            const [inputText, setInputText] = useState('');
            const [output, setOutput] = useState('');
            const [cesarKey, setCesarKey] = useState('');
            const [vigenereKey, setVigenereKey] = useState('');
            const [affineA, setAffineA] = useState('');
            const [affineB, setAffineB] = useState('');
            const [errorMessage, setErrorMessage] = useState('');

            const letters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

            const pgcd = (a, b) => {
                while (b !== 0) {
                    let temp = b;
                    b = a % b;
                    a = temp;
                }
                return a;
            };

            const inverseModulaire = (a, m) => {
                for (let i = 1; i < m; i++) {
                    if ((a * i) % m === 1) {
                        return i;
                    }
                }
                return null;
            };

            const estPremierAvec26 = (a) => {
                return pgcd(a, 26) === 1;
            };

            const chiffrementCesar = (text, key) => {
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (index + key) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const dechiffrementCesar = (text, key) => {
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (index + 26 - key) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const chiffrementVigenere = (text, key) => {
                let result = '';
                let j = 0;
                for (let i = 0; i < text.length; i++) {
                    const textIndex = letters.indexOf(text[i]);
                    if (textIndex !== -1) {
                        const keyIndex = letters.indexOf(key[j % key.length]);
                        const newIndex = (textIndex + keyIndex) % 26;
                        result += letters[newIndex];
                        j++;
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const dechiffrementVigenere = (text, key) => {
                let result = '';
                let j = 0;
                for (let i = 0; i < text.length; i++) {
                    const textIndex = letters.indexOf(text[i]);
                    if (textIndex !== -1) {
                        const keyIndex = letters.indexOf(key[j % key.length]);
                        const newIndex = (textIndex + 26 - keyIndex) % 26;
                        result += letters[newIndex];
                        j++;
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const chiffrementAffine = (text, a, b) => {
                if (!estPremierAvec26(a)) {
                    return null;
                }
                
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (a * index + b) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const dechiffrementAffine = (text, a, b) => {
                if (!estPremierAvec26(a)) {
                    return null;
                }

                const aInv = inverseModulaire(a, 26);
                if (aInv === null) {
                    return null;
                }

                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (aInv * (index - b + 26)) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const handleProcess = () => {
                setErrorMessage('');
                let result = '';
                
                if (mode === 'encrypt') {
                    if (algorithm === 'cesar') {
                        result = chiffrementCesar(inputText, parseInt(cesarKey));
                    } else if (algorithm === 'vigenere') {
                        result = chiffrementVigenere(inputText, vigenereKey);
                    } else if (algorithm === 'affine') {
                        result = chiffrementAffine(inputText, parseInt(affineA), parseInt(affineB));
                        if (result === null) {
                            setErrorMessage(`‚ùå Erreur: ${affineA} n'est pas premier avec 26. Valeurs valides pour 'a': 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25`);
                            setOutput('');
                            return;
                        }
                    }
                } else {
                    if (algorithm === 'cesar') {
                        result = dechiffrementCesar(inputText, parseInt(cesarKey));
                    } else if (algorithm === 'vigenere') {
                        result = dechiffrementVigenere(inputText, vigenereKey);
                    } else if (algorithm === 'affine') {
                        result = dechiffrementAffine(inputText, parseInt(affineA), parseInt(affineB));
                        if (result === null) {
                            setErrorMessage(`‚ùå Erreur: ${affineA} n'est pas premier avec 26. Valeurs valides pour 'a': 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25`);
                            setOutput('');
                            return;
                        }
                    }
                }
                
                setOutput(result);
            };

            const handleReset = () => {
                setInputText('');
                setOutput('');
                setErrorMessage('');
            };

            const renderClassicCrypto = () => (
                <div className="space-y-6">
                    <div className="flex gap-4 mb-6">
                        <button
                            onClick={() => setMode('encrypt')}
                            className={`flex-1 py-4 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 ${
                                mode === 'encrypt'
                                    ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                    : 'bg-slate-800/50 text-slate-300 hover:bg-slate-700/50 border border-purple-500/30'
                            }`}
                        >
                            <Lock className="w-5 h-5" />
                            Chiffrement
                        </button>
                        <button
                            onClick={() => setMode('decrypt')}
                            className={`flex-1 py-4 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 ${
                                mode === 'decrypt'
                                    ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                    : 'bg-slate-800/50 text-slate-300 hover:bg-slate-700/50 border border-purple-500/30'
                            }`}
                        >
                            <Unlock className="w-5 h-5" />
                            D√©chiffrement
                        </button>
                    </div>

                    <div className="bg-slate-800/50 rounded-xl p-6 mb-6 border border-purple-500/30">
                        <div className="flex items-center gap-2 mb-4">
                            <Key className="w-5 h-5 text-pink-400" />
                            <h2 className="text-xl font-semibold text-white">Algorithme Classique</h2>
                        </div>
                        <div className="grid grid-cols-3 gap-3">
                            {['cesar', 'vigenere', 'affine'].map((algo) => (
                                <button
                                    key={algo}
                                    onClick={() => {
                                        setAlgorithm(algo);
                                        setErrorMessage('');
                                    }}
                                    className={`py-3 px-4 rounded-lg font-medium transition-all ${
                                        algorithm === algo
                                            ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                            : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50 border border-purple-500/20'
                                    }`}
                                >
                                    {algo === 'cesar' && 'C√©sar'}
                                    {algo === 'vigenere' && 'Vigen√®re'}
                                    {algo === 'affine' && 'Affine'}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                        <h2 className="text-xl font-semibold text-white mb-4">Configuration</h2>
                        
                        {algorithm === 'cesar' && (
                            <div className="mb-4">
                                <label className="block text-pink-300 mb-2 font-medium">Cl√© C√©sar</label>
                                <input
                                    type="number"
                                    value={cesarKey}
                                    onChange={(e) => setCesarKey(e.target.value)}
                                    className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg border border-purple-500/30"
                                    placeholder="D√©calage (ex: 3, 13)"
                                />
                            </div>
                        )}

                        {algorithm === 'vigenere' && (
                            <div className="mb-4">
                                <label className="block text-pink-300 mb-2 font-medium">Cl√© Vigen√®re</label>
                                <input
                                    type="text"
                                    value={vigenereKey}
                                    onChange={(e) => setVigenereKey(e.target.value)}
                                    className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg border border-purple-500/30"
                                    placeholder="Cl√© texte (ex: WICE)"
                                />
                            </div>
                        )}

                        {algorithm === 'affine' && (
                            <div className="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label className="block text-pink-300 mb-2 font-medium">Valeur 'a'</label>
                                    <input
                                        type="number"
                                        value={affineA}
                                        onChange={(e) => setAffineA(e.target.value)}
                                        className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg border border-purple-500/30"
                                    />
                                </div>
                                <div>
                                    <label className="block text-pink-300 mb-2 font-medium">Valeur 'b'</label>
                                    <input
                                        type="number"
                                        value={affineB}
                                        onChange={(e) => setAffineB(e.target.value)}
                                        className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg border border-purple-500/30"
                                    />
                                </div>
                            </div>
                        )}

                        <div className="space-y-4">
                            <div>
                                <label className="block text-pink-300 mb-2 font-medium">
                                    {mode === 'encrypt' ? 'üìù Message clair' : 'üîí Message chiffr√©'}
                                </label>
                                <textarea
                                    value={inputText}
                                    onChange={(e) => setInputText(e.target.value)}
                                    className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg h-32 border border-purple-500/30"
                                    placeholder="Entrez votre message..."
                                />
                            </div>

                            <div className="flex gap-3">
                                <button
                                    onClick={handleProcess}
                                    className="flex-1 bg-gradient-to-r from-pink-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-pink-700 hover:to-purple-700 transition-all"
                                >
                                    {mode === 'encrypt' ? 'üîê Chiffrer' : 'üîì D√©chiffrer'}
                                </button>
                                <button
                                    onClick={handleReset}
                                    className="px-6 bg-slate-700/50 text-white py-3 rounded-lg font-semibold hover:bg-slate-600/50 transition-all border border-purple-500/30"
                                >
                                    R√©initialiser
                                </button>
                            </div>

                            {output && (
                                <div>
                                    <label className="block text-pink-300 mb-2 font-medium">
                                        {mode === 'encrypt' ? '‚úÖ Message chiffr√©' : '‚úÖ Message d√©chiffr√©'}
                                    </label>
                                    <div className="bg-gradient-to-r from-purple-900/50 to-pink-900/50 text-white px-4 py-3 rounded-lg min-h-32 break-words border-2 border-pink-500/50 font-mono">
                                        {output}
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-950 via-pink-900 to-violet-950 p-4">
                    <div className="max-w-6xl mx-auto">
                        {/* En-t√™te */}
                        <div className="text-center mb-8 pt-8">
                            <div className="inline-flex items-center justify-center gap-3 mb-4 bg-gradient-to-r from-purple-600 to-pink-600 px-8 py-3 rounded-full shadow-2xl">
                                <Flag className="w-8 h-8 text-white animate-pulse" />
                                <h1 className="text-3xl font-bold text-white">WiCE CTF 2025</h1>
                                <Sparkles className="w-8 h-8 text-yellow-300 animate-pulse" />
                            </div>
                            <h2 className="text-2xl font-bold text-white mb-2">Panel Cryptographie</h2>
                            <p className="text-pink-200 text-lg mb-1">Women in Cybersecurity Education</p>
                            <p className="text-purple-300">Capture The Flag - 1√®re √âdition</p>
                            
                            <div className="mt-4 inline-block bg-purple-800/50 px-6 py-2 rounded-full border border-purple-400" style={{backdropFilter: 'blur(10px)'}}>
                                <span className="text-purple-200 font-semibold">Cyber221 x WiCE x TDSI/LACGAA</span>
                            </div>
                        </div>

                        {/* Navigation par onglets */}
                        <div className="bg-slate-800/50 rounded-xl p-2 mb-6 border border-purple-500/30">
                            <div className="grid grid-cols-4 gap-2">
                                {[
                                    { id: 'classique', name: 'üîì Classique', color: 'from-purple-600 to-pink-600' },
                                    { id: 'symetrique', name: '‚ö° Moderne', color: 'from-blue-600 to-cyan-600' },
                                    { id: 'asymetrique', name: 'üîë Asym√©trique', color: 'from-green-600 to-emerald-600' },
                                    { id: 'hachage', name: 'üîê Hachage', color: 'from-indigo-600 to-purple-600' }
                                ].map((tab) => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`py-3 px-4 rounded-lg font-semibold transition-all ${
                                            activeTab === tab.id
                                                ? `bg-gradient-to-r ${tab.color} text-white shadow-lg`
                                                : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50'
                                        }`}
                                    >
                                        {tab.name}
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Contenu des onglets */}
                        <div className="bg-slate-800/50 rounded-xl p-6 border border-purple-500/30">
                            {activeTab === 'classique' && renderClassicCrypto()}
                            {activeTab === 'symetrique' && <AESManager />}
                            {activeTab === 'asymetrique' && <RSAManager />}
                            {activeTab === 'hachage' && <HashManager />}
                        </div>

                        {/* Pied de page */}
                        <div className="text-center text-purple-300 pb-8 mt-8">
                            <p className="mb-4">Une initiative de la TDSI/LACGAA pour le programme Women in Cybersecurity Education</p>
                            <p className="text-sm mb-6">Cyber221 - WiCE CTF 2025 - TDSI/LACGAA</p>
                            
                            <div className="border-t border-purple-500/30 pt-6 mt-6">
                                <p className="text-pink-200 font-semibold mb-3">D√©velopp√© par :</p>
                                <div className="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-8">
                                    <a 
                                        href="https://www.linkedin.com/in/ousmane-deme1618/" 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="flex items-center gap-2 text-purple-200 hover:text-pink-300 transition-colors"
                                    >
                                        <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                        </svg>
                                        <span className="font-medium">Ousmane DEME</span>
                                    </a>
                                    <span className="hidden sm:inline text-purple-500">‚Ä¢</span>
                                    <a 
                                        href="https://www.linkedin.com/in/serigne-fallou-thiam/" 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="flex items-center gap-2 text-purple-200 hover:text-pink-300 transition-colors"
                                    >
                                        <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                        </svg>
                                        <span className="font-medium">Serigne Fallou THIAM</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CryptoApp />, document.getElementById('root'));
    </script>
</body>
</html>