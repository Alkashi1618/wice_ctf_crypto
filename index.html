<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WiCE CTF 2025 - CryptoApp</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, sans-serif;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide Icons as SVG components
        const Lock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
        );

        const Unlock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 9.9-1"/>
            </svg>
        );

        const Key = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
            </svg>
        );

        const Shield = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
        );

        const Flag = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                <line x1="4" y1="22" x2="4" y2="15"/>
            </svg>
        );

        const Sparkles = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"/>
            </svg>
        );

        const AlertCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        const CryptoApp = () => {
            const [mode, setMode] = useState('encrypt');
            const [algorithm, setAlgorithm] = useState('cesar');
            const [inputText, setInputText] = useState('');
            const [output, setOutput] = useState('');
            const [cesarKey, setCesarKey] = useState('');
            const [vigenereKey, setVigenereKey] = useState('');
            const [affineA, setAffineA] = useState('');
            const [affineB, setAffineB] = useState('');
            const [showChallenge, setShowChallenge] = useState(false);
            const [errorMessage, setErrorMessage] = useState('');

            const letters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

            const pgcd = (a, b) => {
                while (b !== 0) {
                    let temp = b;
                    b = a % b;
                    a = temp;
                }
                return a;
            };

            const inverseModulaire = (a, m) => {
                for (let i = 1; i < m; i++) {
                    if ((a * i) % m === 1) {
                        return i;
                    }
                }
                return null;
            };

            const estPremierAvec26 = (a) => {
                return pgcd(a, 26) === 1;
            };

            const chiffrementCesar = (text, key) => {
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (index + key) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const dechiffrementCesar = (text, key) => {
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (index + 26 - key) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const chiffrementVigenere = (text, key) => {
                let result = '';
                let j = 0;
                for (let i = 0; i < text.length; i++) {
                    const textIndex = letters.indexOf(text[i]);
                    if (textIndex !== -1) {
                        const keyIndex = letters.indexOf(key[j % key.length]);
                        const newIndex = (textIndex + keyIndex) % 26;
                        result += letters[newIndex];
                        j++;
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const dechiffrementVigenere = (text, key) => {
                let result = '';
                let j = 0;
                for (let i = 0; i < text.length; i++) {
                    const textIndex = letters.indexOf(text[i]);
                    if (textIndex !== -1) {
                        const keyIndex = letters.indexOf(key[j % key.length]);
                        const newIndex = (textIndex + 26 - keyIndex) % 26;
                        result += letters[newIndex];
                        j++;
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const chiffrementAffine = (text, a, b) => {
                if (!estPremierAvec26(a)) {
                    return null;
                }
                
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (a * index + b) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const dechiffrementAffine = (text, a, b) => {
                if (!estPremierAvec26(a)) {
                    return null;
                }

                const aInv = inverseModulaire(a, 26);
                if (aInv === null) {
                    return null;
                }

                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const index = letters.indexOf(text[i]);
                    if (index !== -1) {
                        const newIndex = (aInv * (index - b + 26)) % 26;
                        result += letters[newIndex];
                    } else {
                        result += text[i];
                    }
                }
                return result;
            };

            const handleProcess = () => {
                setErrorMessage('');
                let result = '';
                
                if (mode === 'encrypt') {
                    if (algorithm === 'cesar') {
                        result = chiffrementCesar(inputText, parseInt(cesarKey));
                    } else if (algorithm === 'vigenere') {
                        result = chiffrementVigenere(inputText, vigenereKey);
                    } else if (algorithm === 'affine') {
                        result = chiffrementAffine(inputText, parseInt(affineA), parseInt(affineB));
                        if (result === null) {
                            setErrorMessage(`‚ùå Erreur: ${affineA} n'est pas premier avec 26. Valeurs valides pour 'a': 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25`);
                            setOutput('');
                            return;
                        }
                    }
                } else {
                    if (algorithm === 'cesar') {
                        result = dechiffrementCesar(inputText, parseInt(cesarKey));
                    } else if (algorithm === 'vigenere') {
                        result = dechiffrementVigenere(inputText, vigenereKey);
                    } else if (algorithm === 'affine') {
                        result = dechiffrementAffine(inputText, parseInt(affineA), parseInt(affineB));
                        if (result === null) {
                            setErrorMessage(`‚ùå Erreur: ${affineA} n'est pas premier avec 26. Valeurs valides pour 'a': 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25`);
                            setOutput('');
                            return;
                        }
                    }
                }
                
                setOutput(result);
            };

            const handleReset = () => {
                setInputText('');
                setOutput('');
                setErrorMessage('');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-950 via-pink-900 to-violet-950 p-4">
                    <div className="max-w-4xl mx-auto">
                        <div className="text-center mb-8 pt-8">
                            <div className="inline-flex items-center justify-center gap-3 mb-4 bg-gradient-to-r from-purple-600 to-pink-600 px-8 py-3 rounded-full shadow-2xl">
                                <Flag className="w-8 h-8 text-white animate-pulse" />
                                <h1 className="text-3xl font-bold text-white">WiCE CTF 2025</h1>
                                <Sparkles className="w-8 h-8 text-yellow-300 animate-pulse" />
                            </div>
                            <h2 className="text-2xl font-bold text-white mb-2">Panel Cryptographie</h2>
                            <p className="text-pink-200 text-lg mb-1">Women in Cybersecurity Education</p>
                            <p className="text-purple-300">Capture The Flag - 1√®re √âdition</p>
                            
                            <div className="mt-4 inline-block bg-purple-800/50 px-6 py-2 rounded-full border border-purple-400" style={{backdropFilter: 'blur(10px)'}}>
                                <span className="text-purple-200 font-semibold">üîê Cyber221 x WiCE x TDSI/LACGAA</span>
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-pink-600 to-purple-600 rounded-xl p-4 mb-6 shadow-xl">
                            <div className="flex items-center justify-between flex-wrap gap-4">
                                <div className="flex items-center gap-3">
                                    <Shield className="w-6 h-6 text-white" />
                                    <div>
                                        <h3 className="text-white font-bold">D√©monstration Interactive</h3>
                                        <p className="text-pink-100 text-sm">Explorez les algorithmes de chiffrement classiques</p>
                                    </div>
                                </div>
                                <button
                                    onClick={() => setShowChallenge(!showChallenge)}
                                    className="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-all font-semibold"
                                >
                                    {showChallenge ? 'Masquer' : 'Mini Challenge'}
                                </button>
                            </div>
                        </div>

                        {showChallenge && (
                            <div className="bg-yellow-500/10 border-2 border-yellow-500 rounded-xl p-6 mb-6 shadow-xl">
                                <div className="flex items-start gap-3 mb-4">
                                    <Flag className="w-6 h-6 text-yellow-400 mt-1" />
                                    <div>
                                        <h3 className="text-yellow-300 font-bold text-lg mb-2">üéØ Challenge: D√©chiffrez le message !</h3>
                                        <p className="text-white mb-3">Message chiffr√© avec C√©sar (cl√© = 13) :</p>
                                        <div className="bg-black/30 p-4 rounded-lg mb-3">
                                            <code className="text-green-400 font-mono">Jvpr PGS rfg har pbzcrgvgvba cnffvbaaagr !</code>
                                        </div>
                                        <p className="text-pink-200 text-sm">üí° Indice : Essayez diff√©rentes valeurs de cl√© C√©sar pour trouver le message original</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="flex gap-4 mb-6">
                            <button
                                onClick={() => setMode('encrypt')}
                                className={`flex-1 py-4 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 ${
                                    mode === 'encrypt'
                                        ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                        : 'bg-slate-800/50 text-slate-300 hover:bg-slate-700/50 border border-purple-500/30'
                                }`}
                                style={mode === 'encrypt' ? {} : {backdropFilter: 'blur(10px)'}}
                            >
                                <Lock className="w-5 h-5" />
                                Chiffrement
                            </button>
                            <button
                                onClick={() => setMode('decrypt')}
                                className={`flex-1 py-4 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 ${
                                    mode === 'decrypt'
                                        ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                        : 'bg-slate-800/50 text-slate-300 hover:bg-slate-700/50 border border-purple-500/30'
                                }`}
                                style={mode === 'decrypt' ? {} : {backdropFilter: 'blur(10px)'}}
                            >
                                <Unlock className="w-5 h-5" />
                                D√©chiffrement
                            </button>
                        </div>

                        <div className="bg-slate-800/50 rounded-xl p-6 mb-6 shadow-xl border border-purple-500/30" style={{backdropFilter: 'blur(10px)'}}>
                            <div className="flex items-center gap-2 mb-4">
                                <Key className="w-5 h-5 text-pink-400" />
                                <h2 className="text-xl font-semibold text-white">Algorithme de Chiffrement</h2>
                            </div>
                            <div className="grid grid-cols-3 gap-3">
                                <button
                                    onClick={() => {
                                        setAlgorithm('cesar');
                                        setErrorMessage('');
                                    }}
                                    className={`py-3 px-4 rounded-lg font-medium transition-all ${
                                        algorithm === 'cesar'
                                            ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                            : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50 border border-purple-500/20'
                                    }`}
                                >
                                    C√©sar
                                </button>
                                <button
                                    onClick={() => {
                                        setAlgorithm('vigenere');
                                        setErrorMessage('');
                                    }}
                                    className={`py-3 px-4 rounded-lg font-medium transition-all ${
                                        algorithm === 'vigenere'
                                            ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                            : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50 border border-purple-500/20'
                                    }`}
                                >
                                    Vigen√®re
                                </button>
                                <button
                                    onClick={() => {
                                        setAlgorithm('affine');
                                        setErrorMessage('');
                                    }}
                                    className={`py-3 px-4 rounded-lg font-medium transition-all ${
                                        algorithm === 'affine'
                                            ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg'
                                            : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50 border border-purple-500/20'
                                    }`}
                                >
                                    Affine
                                </button>
                            </div>
                        </div>

                        <div className="bg-slate-800/50 rounded-xl p-6 mb-6 shadow-xl border border-purple-500/30" style={{backdropFilter: 'blur(10px)'}}>
                            <h2 className="text-xl font-semibold text-white mb-4">Configuration de la Cl√©</h2>
                            
                            {algorithm === 'cesar' && (
                                <div>
                                    <label className="block text-pink-300 mb-2 font-medium">Cl√© C√©sar (d√©calage)</label>
                                    <input
                                        type="number"
                                        value={cesarKey}
                                        onChange={(e) => setCesarKey(e.target.value)}
                                        className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 border border-purple-500/30"
                                        placeholder="Entrez un nombre (ex: 3, 13)"
                                    />
                                </div>
                            )}

                            {algorithm === 'vigenere' && (
                                <div>
                                    <label className="block text-pink-300 mb-2 font-medium">Cl√© Vigen√®re (texte)</label>
                                    <input
                                        type="text"
                                        value={vigenereKey}
                                        onChange={(e) => setVigenereKey(e.target.value)}
                                        className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 border border-purple-500/30"
                                        placeholder="Entrez la cl√© (ex: WICE, CYBER)"
                                    />
                                </div>
                            )}

                            {algorithm === 'affine' && (
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-pink-300 mb-2 font-medium">
                                            Valeur 'a' (doit √™tre premier avec 26)
                                        </label>
                                        <input
                                            type="number"
                                            value={affineA}
                                            onChange={(e) => {
                                                setAffineA(e.target.value);
                                                setErrorMessage('');
                                            }}
                                            className={`w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 border ${
                                                estPremierAvec26(parseInt(affineA)) 
                                                    ? 'focus:ring-pink-500 border-purple-500/30' 
                                                    : 'focus:ring-red-500 border-red-500/50'
                                            }`}
                                        />
                                        <p className="text-xs text-purple-300 mt-2">
                                            Valeurs valides: 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25
                                        </p>
                                        {!estPremierAvec26(parseInt(affineA)) && affineA !== '' && parseInt(affineA) !== 0 && (
                                            <p className="text-xs text-red-400 mt-1 flex items-center gap-1">
                                                <AlertCircle className="w-3 h-3" />
                                                {affineA} n'est pas premier avec 26
                                            </p>
                                        )}
                                    </div>
                                    <div>
                                        <label className="block text-pink-300 mb-2 font-medium">Valeur 'b'</label>
                                        <input
                                            type="number"
                                            value={affineB}
                                            onChange={(e) => setAffineB(e.target.value)}
                                            className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 border border-purple-500/30"
                                        />
                                    </div>
                                </div>
                            )}
                        </div>

                        {errorMessage && (
                            <div className="bg-red-500/10 border-2 border-red-500 rounded-xl p-4 mb-6 shadow-xl">
                                <div className="flex items-start gap-3">
                                    <AlertCircle className="w-5 h-5 text-red-400 mt-0.5" />
                                    <p className="text-red-300 font-medium">{errorMessage}</p>
                                </div>
                            </div>
                        )}

                        <div className="bg-slate-800/50 rounded-xl p-6 mb-6 shadow-xl border border-purple-500/30" style={{backdropFilter: 'blur(10px)'}}>
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-pink-300 mb-2 font-medium">
                                        {mode === 'encrypt' ? 'üìù Message clair' : 'üîí Message chiffr√©'}
                                    </label>
                                    <textarea
                                        value={inputText}
                                        onChange={(e) => setInputText(e.target.value)}
                                        className="w-full bg-slate-700/50 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 h-32 border border-purple-500/30"
                                        placeholder="Entrez votre message..."
                                    />
                                </div>

                                <div className="flex gap-3">
                                    <button
                                        onClick={handleProcess}
                                        className="flex-1 bg-gradient-to-r from-pink-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-pink-700 hover:to-purple-700 transition-all shadow-lg"
                                    >
                                        {mode === 'encrypt' ? 'üîê Chiffrer' : 'üîì D√©chiffrer'}
                                    </button>
                                    <button
                                        onClick={handleReset}
                                        className="px-6 bg-slate-700/50 text-white py-3 rounded-lg font-semibold hover:bg-slate-600/50 transition-all border border-purple-500/30"
                                    >
                                        R√©initialiser
                                    </button>
                                </div>

                                {output && (
                                    <div>
                                        <label className="block text-pink-300 mb-2 font-medium">
                                            {mode === 'encrypt' ? '‚úÖ Message chiffr√©' : '‚úÖ Message d√©chiffr√©'}
                                        </label>
                                        <div className="bg-gradient-to-r from-purple-900/50 to-pink-900/50 text-white px-4 py-3 rounded-lg min-h-32 break-words border-2 border-pink-500/50 font-mono">
                                            {output}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="text-center text-purple-300 pb-8">
                            <p className="mb-4">üíú Une initiative du programme Women in Cybersecurity Education</p>
                            <p className="text-sm mb-6">Cyber221 - WiCE CTF 2025 - TDSI/LACGAA</p>
                            
                            <div className="border-t border-purple-500/30 pt-6 mt-6">
                                <p className="text-pink-200 font-semibold mb-3">D√©velopp√© par :</p>
                                <div className="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-8">
                                    <a 
                                        href="https://www.linkedin.com/in/ousmane-deme1618/" 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="flex items-center gap-2 text-purple-200 hover:text-pink-300 transition-colors"
                                    >
                                        <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                        </svg>
                                        <span className="font-medium">Ousmane DEME</span>
                                    </a>
                                    <span className="hidden sm:inline text-purple-500">‚Ä¢</span>
                                    <a 
                                        href="https://www.linkedin.com/in/serigne-fallou-thiam/" 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="flex items-center gap-2 text-purple-200 hover:text-pink-300 transition-colors"
                                    >
                                        <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                        </svg>
                                        <span className="font-medium">Serigne Fallou THIAM</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CryptoApp />, document.getElementById('root'));
    </script>
</body>
</html>